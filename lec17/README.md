Лекція №17: Породжувальні патерни — Factory Method та Singleton
Вступ до Патернів Проєктування
Патерни проєктування — це типові рішення для проблем, які часто виникають під час розробки програм. Це не готові бібліотеки чи фреймворки, а скоріше шаблони, які можна адаптувати під свою задачу.

Вони потрібні щоб:
Не вигадувати велосипед кожного разу
Розробникам було простіше розуміти одне одного
Код був гнучким і його можна було легко змінювати

Патерни діляться на три групи:
Породжувальні — для створення об'єктів
Структурні — для побудови класів
Поведінкові — для взаємодії між об'єктами

Патерни: Factory Method та Singleton.

Патерн Factory Method
Призначення

Визначає інтерфейс для створення об'єкта, але дозволяє підкласам вирішувати, який саме клас створювати. Фабричний метод дозволяє делегувати створення об'єктів підкласам.

Проблема

Клас не знає заздалегідь, які об'єкти йому доведеться створювати, або хоче віддати цю відповідальність іншим класам.

Структура

Product — інтерфейс або абстрактний клас, який описує продукти
ConcreteProduct — конкретна реалізація продукту
Creator — оголошує фабричний метод, який повертає продукт
ConcreteCreator — перевизначає фабричний метод і повертає конкретний продукт

Приклад

Уявімо систему логування. Є консольний логер і файловий логер. Замість того щоб створювати їх напряму, ми робимо фабрику логерів. Клієнтський код працює тільки з фабрикою і не знає, який саме логер прийде. Якщо додати новий тип логера — змінювати клієнтський код не доведеться.

Переваги

Не порушує принцип відкритості/закритості — нові продукти можна додавати без змін старого коду
Слабке зв'язування — клієнт залежить тільки від інтерфейсу, а не від конкретних класів

Патерн Singleton
Призначення

Гарантує, що клас має лише один екземпляр, і надає глобальну точку доступу до нього.

Проблема

Потрібно, щоб певний ресурс існував тільки в одному екземплярі — наприклад, налаштування програми, системний логер, пул з'єднань з базою даних.

Структура

Приватний статичний екземпляр класу
Приватний конструктор — щоб ніхто ззовні не міг створити об'єкт
Публічний статичний метод або властивість для доступу до єдиного екземпляра

Приклад

Клас менеджера конфігурації. Ми не хочемо щоразу завантажувати налаштування з файлу, коли нам потрібно щось прочитати. Тому створюємо один екземпляр при першому зверненні, і далі всі звертаються до нього.

Переваги

Контрольований доступ — ми точно знаємо, що є тільки один екземпляр
Економія ресурсів — не створюємо зайві об'єкти
Зручний доступ — можна звернутися з будь-якого місця програми

Недоліки

Важко тестувати — підмінити синглтон на мок-об'єкт проблематично
Порушує принцип єдиної відповідальності — клас займається і своєю логікою, і управлінням своїм життєвим циклом
Може створити жорстку зв'язаність — багато класів починають залежати від одного синглтона
